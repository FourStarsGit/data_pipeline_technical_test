= Test technique Thomas ZUK

== Projet de Data Pipeline

=== Description du projet

=== Pré-requis

=== Exécution

=== Traitement Ad-Hoc

== Réponses aux Questions (Pour aller plus loin)

== Réponses à la partie SQL

=== Première partie du test

Solution proposée :

[source,sql]
----
SELECT date, sum(prod_price * prod_qty) as ventes
FROM TRANSACTION
WHERE date BETWEEN '01/01/2019' AND '31/12/2019'
GROUP BY date
ORDER BY date;
----

En prenant pour hypothèse que le format des dates dans la base est `dd/MM/yyyy`.

=== Seconde partie du test

Solution proposée :

[source,sql]
----
SELECT client_id,
	SUM(CASE WHEN product_type='MEUBLE' THEN prod_price * prod_qty ELSE 0 END) as ventes_meuble,
	SUM(CASE WHEN product_type='DECO' THEN prod_price * prod_qty ELSE 0 END) as ventes_deco
FROM TRANSACTION t
JOIN PRODUCT_NOMENCLATURE p
ON t.prod_id = p.product_id
WHERE date BETWEEN '01/01/2019' AND '31/12/2019'
GROUP BY client_id;
----

En prenant toujours pour hypothèse que le format des dates dans la base est `dd/MM/yyyy`.